"use strict";function locationFormatResult(a){return"<li class='venue-info'>"+a.venue.name+"</li>"}function locationHash(a){var b={name:a.venue.name,lat:a.venue.location?a.venue.location.lat:"",lng:a.venue.location?a.venue.location.lng:""};return JSON.stringify(b)}function locationFormatSelection(a){return a.venue.name}var app=angular.module("pandamoniumApp",["ngCookies","ngResource","ngSanitize","ngRoute","btford.socket-io","ui.select2"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/addQuestion",{templateUrl:"views/addQuestion.html",controller:"AddQuestionCtrl"}).when("/callback",{templateUrl:"views/callback.html",controller:"CallbackCtrl"}).when("/question/:id",{templateUrl:"views/question.html",controller:"QuestionCtrl"}).when("/question/:id/reply",{templateUrl:"views/replyQuestion.html",controller:"ReplyQuestionCtrl"}).otherwise({redirectTo:"/"})}]),app.run(["$rootScope","$cookieStore",function(a){a.auth0=new Auth0Widget({domain:"pandamonium.auth0.com",clientID:"fWAN4aT5cD8jLE9vWaIRqN9mMJSPZIGI",callbackURL:"http://"+window.location.host+"/#/callback",callbackOnLocationHash:!1})}]);var app=angular.module("pandamoniumApp");app.factory("BaseModel",["BaseResource",function(a){var b=function(b){this.data=b.model,b.hasOwnProperty("resource")&&(this.resource=new a(b.resource))};return b.prototype.fetch=function(){var a=this;this.hasOwnProperty("resource")&&this.resource.get(function(b){a.data=b})},b}]);var app=angular.module("pandamoniumApp");app.factory("QuestionModel",["BaseModel","QuestionResource","$rootScope",function(a,b,c){var d={token:c.token};return new a(d,b)}]);var app=angular.module("pandamoniumApp");app.factory("BaseResource",["$resource",function(a){var b={baseURL:"http://www.mocky.io",baseParams:{},baseOptions:{},endPoint:"/v2/527ec073fbe1d29a00e1ba2b"};return function(c){var d=c.params||{},e=c.options||{},f=c.baseURL||b.baseURL,g=(c.endpoint||b.endpoint,f+"/:id"),h=_.extend(d,b.baseParams),i=_.extend(e,b.baseOptions);return a(g,h,i)}}]);var app=angular.module("pandamoniumApp");app.factory("QuestionResource",["BaseResource",function(a){var b="/v2/527ec073fbe1d29a00e1ba2b",c={},d={};return new a(b,c,d)}]);var app=angular.module("pandamoniumApp");app.factory("GeoService",["$q","$rootScope",function(a,b){return function(){b.changeLocation=function(a){console.log(a),b.$broadcast("locationChanged",{coordinates:a})};var c=a.defer();return setTimeout(function(){try{navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){b.$apply(function(){a.coords.longitude;b.changeLocation(a.coords),c.resolve({aField:"Hello "+a.coords.longitude+"!"})})},function(a){c.reject(a)}):c.reject("location services not allowed")}catch(a){c.reject(a)}},500),c.promise}}]);var app=angular.module("pandamoniumApp");app.controller("MainCtrl",["$scope","$sanitize","$resource","$rootScope","$location",function(a,b,c,d,e){d.controller="MainCtrl";{var f=c("/api/v1/question/:id",{id:"@id"});setInterval(function(){a.questions=f.query()},1e3)}a.locationSelect={minimumInputLength:1,ajax:{quietMillis:50,url:function(a){return d.coords?"/api/v1/venues/explore/"+d.coords.latitude+"/"+d.coords.longitude+"/"+b(a):void 0},data:function(){},results:function(a){return{results:JSON.parse(a).response.groups[0].items}}},formatResult:locationFormatResult,formatSelection:locationFormatSelection},a.viewQuestion=function(a){e.path("/question/"+a)}}]);var app=angular.module("pandamoniumApp");app.controller("AddQuestionCtrl",["$scope","$rootScope","$location",function(a,b){b.controller="AddQuestionCtrl"}]),angular.module("pandamoniumApp").controller("CallbackCtrl",["$cookieStore","$rootScope","$window","$location",function(a,b,c,d){a.put("oauthcode",c.location.search),d.path("/")}]);var app=angular.module("pandamoniumApp");app.controller("GeoLocationCtrl",["$scope","GeoService","$rootScope",function(a,b,c){b(),a.$on("locationChanged",function(a,b){c.coords=b.coordinates})}]);var app=angular.module("pandamoniumApp");app.controller("LoginCtrl",["$cookieStore","$scope","$rootScope","$window","$location","AuthObj",function(a,b,c,d,e,f){a.put("oauthcode",d.location.search),e.path("/"),b.loginButtonText="Login",b.loginUser=function(){f.getLoginStatus()||f.login(),b.auth0.show({connections:["twitter","facebook","google-oauth2"],icon:"//logo-32.png",showIcon:!0}),b.loginButtonText="LogOut"},b.logoutUser=function(){f.getLoginStatus()&&f.logout(),b.loginButtonText="Login"},b.$watch(f.getLoginStatus,function(a){b.loginButtonText=a})}]),app.service("AuthObj",["$rootScope",function(){var a="Login";return{login:function(){a="Logout"},logout:function(){$window.location.href="https://pandamonium.auth0.com/logout?returnTo="+window.location.href,a="Login"},getLoginStatus:function(){return a}}}]);var app=angular.module("pandamoniumApp");app.controller("NavBarCtrl",["$scope","$rootScope","$resource","$location","$routeParams",function(a,b,c,d,e){a.addQuestion=function(){d.path("addQuestion")},a.saveQuestion=function(){var a=c("/api/v1/question/"),b={};b.q=$("#newQuestion").val(),b.qlat=74,b.qlong=-125,b.alat=75,b.along=-122,b.dist=50,a.save(b),d.path("main")},a.replyQuestion=function(){d.path("/question/"+e.id+"/reply")},a.replyToQuestion=function(){var a=c("/api/v1/question/"+e.id+"/answer"),b={};b.answer=$("#replyToQuestionInput").val(),b.alat=75,b.along=-122,a.save(b),d.path("/question/"+e.id)}}]);var app=angular.module("pandamoniumApp");app.controller("QuestionCtrl",["$scope","$rootScope","$resource","$routeParams",function(a,b,c,d){b.controller="QuestionCtrl";var e=c("/api/v1/question/:id",{id:"@id"});a.question=e.get({id:d.id})}]);var app=angular.module("pandamoniumApp");app.controller("RecentQuestionsCtrl",["$scope","$http","$resource","BaseModel",function(a,b,c){a.questions=[];{var d=c("/api/v1/question/:id",{id:"@id"});setInterval(function(){a.questions=d.query()},1e3)}}]);var app=angular.module("pandamoniumApp");app.controller("ReplyQuestionCtrl",["$scope","$rootScope",function(a,b){b.controller="ReplyQuestionCtrl"}]);